# この一冊で全部わかるサーバーの基本


<!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->

<!-- code_chunk_output -->

- [この一冊で全部わかるサーバーの基本](#この一冊で全部わかるサーバーの基本)
  - [01 サーバーとは](#01-サーバーとは)
  - [02 ネットワークの基礎知識](#02-ネットワークの基礎知識)
  - [03 サーバーを用意する](#03-サーバーを用意する)
  - [04 社内サーバーの基本](#04-社内サーバーの基本)
  - [05 公開サーバーの基本](#05-公開サーバーの基本)
  - [06 サーバーを障害から守る](#06-サーバーを障害から守る)
  - [07 サーバーのセキュリティ](#07-サーバーのセキュリティ)
  - [08 サーバーの運用管理](#08-サーバーの運用管理)

<!-- /code_chunk_output -->

## 01 サーバーとは
- サーバー：クライアントにいろいろなサービスを提供するコンピュータのこと
  - クライアントの例：webブラウザ
- クライアントから要求されて初めて、サーバーは処理を開始し、サービスを提供する（レスポンスを返す）：**クライアント／サーバーシステム**
  - クライアントがサーバーに何かしらのサービスを要求する
    - WebブラウザがWebサーバーに「このサイトのデータをください」と要求する
  - サーバーは要求に応じた処理を行う
    - Webサーバーがそのサイトのファイルを見つけ出す
  - サーバーは処理結果をクライアントに返す
    - WebサーバーがそのファイルをWebブラウザに渡す
  - クライアントは処理結果を受け取る
    - Webブラウザがそのファイルを受け取り、画面に表示する
- サーバーを構築するには？
  - コンピュータにソフトウェアをインストールして、起動すればよい
    - サーバーは、サーバーソフトウェアが持つ機能のこと。つまり、そのソフトウェアをインストールすれば、サーバーを使えるようになる
  - 1台のコンピュータに複数のサーバーを入れることはもちろん可能
    - ただし、そのコンピュータが壊れると、入っている全てのサーバーに影響があるというリスクも伴うことは忘れずに
- サーバーの種類とサーバーソフトウェアの選び方
  - どのサーバーを用意するか？は「何をしたいか？」による
    - メールを受信したいのに、Webサーバーをたてても意味がない
  - サーバーソフトウェアの選択肢は限られており、どれを選ぶかの問題
    - 対応しているOS、プログラミング環境、要求されている機能、ランニングコストなど、いろんな要素を比較して決める
- 運用と管理
  - 設定を変更したい、という全ての要求を聞き入れるわけにはいかないので、設定する範囲を決めたドキュメントなどを残しておくと、管理がしやすくなる
  - 障害対応
    - 事前対応
      - 日々のモニタリング、脆弱性情報やバグのチェックなど
    - 事後対応
      - サーバーのどこにどんな障害が起きたのかをログなどで確認し、適切な対応を行う
- ネットワークとの関係
  - サーバーとクライアントをつなぐのがネットワーク
  - ここでいうネットワークは「コンピューターネットワーク」のこと
    - インターネットやLANが身近なコンピューターネットワーク

## 02 ネットワークの基礎知識
- サーバーを接続する、無線LANはクライアント側だけのもの
- OSI参照モデル
  - 7層のやつ
![OSI](./images/osi.png)
  - 通信機能の役割を階層的に分類した概念
  - 
  - 各階層の役割は異なる。互いの動作に影響を与えることがないし、トラブルシューティングもしやすい。
  - 各層から各層への通信にはそれぞれのプロトコルがある
    - イーサネット、Wi-Fiは物理層からデータリンク層、IPはネットワーク層、など
  - 送信は上から下、受信は下から上
    - 実際の通信は、NIC（Network Interface Card, ネットワークアダプタ）のデバイスドライバーやOS、アプリケーションが各層で使用するプロトコルを選んで処理するが、自動で行なわれるので、ユーザが意識することはない
- プロトコル
  - ネットワークの世界において、通信する時の約束事
    - httpsとかね
  - プロトコルは、パケット（送りたいデータを分割したもの）の送り先、順番を定義する
    - プロトコルの送り先は「ヘッダー」で見分ける
- イーサネット：物理層とデータリンク層で必要不可欠な規格
  - イーサネットフレームを作って、LANケーブルに流す電気信号や、光ファイバに流す光信号に変換してケーブルに流す
- MACアドレス：コンピュータを識別する
  - NICに自動で割り当てられる
  - 48ビットを8ビットずつ、ハイフンやコロンで区切って16進数で表記する
    - 上位24ビット：IEEEが機器のベンダーごとに割り当てたベンダーコード：OUI（Organizationally Unique Identifier）と呼ばれる
    - 下位24ビット：ベンダー内で機器ごとに割り当てている一意のコード
  - コンピュータがデータを送信するときは自分のMACアドレスを「送信元MACアドレス」に、データを送る相手のMACアドレスを「あて先MACアドレス」としてヘッダーに入れる
- スイッチング：スイッチの行なうフレーム転送
  - イーサネットは「スイッチ」を中心として、コンピュータを配置していく「スター型トポロジー」という形態でコンピュータ同士を接続している
  - MACアドレステーブル：スイッチがスイッチングで使用するインターフェイス番号と送信元MACアドレスのテーブル
    - イーサネットワークにおける通信効率の向上を図る
![ethernet](./images/ethernet.png)
- IPアドレス：ネットワーク層で最も重要なプロトコル
  - IP：トランスポート層から受け取ったデータにIPヘッダーをくっつけてIPパケットにする
  - IPアドレスでコンピュータを識別する
  - サブネットマスクとセットで使う
    - 10進数表記とCIDR表記
      - .で区切るやつと、IPアドレスの後ろにスラッシュとサブネットマスクの「1」の個数を付与するやつ
  - ネットワーク部とホスト部（サブネットマスクで分割される）
    - ネットワークそのものと、ネットワークに接続しているコンピュータそのもの
- ルーティング：IPパケットをバケツリレーして、データを目的地まで届けること
  - イーサネットで作ったネットワークとネットワークをつなぐときに使用するネットワーク機器が「ルーター」
  - たくさんのルーターが網目状にネットワークを繋ぐことで、インターネットが成り立っている
  - IPパケットの受け渡し先は「ルーティングテーブル」で管理する
    - 宛先ネットワークとネクストホップ（あて先ネットワークに対する、送り先のIPアドレス）
  - 静的ルーティングと動的ルーティング
    - ルーティングテーブルを手動で管理するか、隣接するルーター間でルート情報を交換（ルーティングプロトコルというプロトコルが定められている）して、自動的にルーティングテーブルを作る
    - 小規模なネットワーク、中・大規模なネットワーク
- ARP（Adress Resolution Protocol）：物理（MACアドレス）と論理（IPアドレス）を関連づける
  - あて先MACアドレスを判別するために使われる
  - データを送るコンピュータがネットワーク層からIPパケットを受け取ると、パケットのあて先IPアドレスを見る
  - あて先が同じネットワークにいるコンピュータであれば、そのIPアドレスをARPで問い合わせ（ARPリクエスト）
    - その応答結果（ARPリプライ）をARPテーブルに登録し、それをもとにイーサネットフレームを作る
  - 異なるネットワークのコンピュータの場合、デフォルトゲートウェイ（自分以外のネットワークに行くときに使用する出口のIPアドレス（≒経由先））のMACアドレスをARPで問い合わせ、↑と同じ処理を行う
- TCPとUDP
  - データを大事にしっかりやり取りしたい時はTCP（Transmission Control Protocol）
    - 「送ったよ」「届いたよ」をきちんと確認しあう
    - Web、メール、ファイル共有など
  - データの信頼性は横に置いておいて、とにかく早く送りたい時はUDP(User Datagram Protocol)
    - 送ったら送りっぱなし
    - IP電話、動画配信、時刻同期など
  - ポート番号を見て、コンピュータの中のどのサービスにデータを渡せば良いかを識別する
    - ウェルノウンポート：0~1023
      - 一般的なサーバーソフトウェアがクライアントのサービス要求を待ち受けるときに使う
    - レジスタードポート：1024~49151
      - メーカー独自のサーバーソフトウェアがクライアントのサービス要求を待ち受けるときに使う
    - ダイナミックポート：49152~65535
      - サーバーがクライアントソフトウェアを識別するために使う
- ポート番号
  - コンピューターの中で動作しているアプリケーションを識別するために使う数字
- NATとNAPT
  - プライベートIPアドレスをグローバルIPアドレスに変換する技術
  - NAT：ネットワークアドレス変換
    - IPアドレスを1対1で変換する
  - NAPT：ネットワークアドレスポート変換
    - IPアドレスとポート番号を変換する

## 03 サーバーを用意する
- サーバーの初期設定は、システム全体の未来を決めると言っても過言ではない
- ポイントは、どこにサーバーを設置するか、どんなsサーバーを設置するかの2つ
- オンプレミスとクラウド
  - オンプレミス：自社で保有する、カスタマイズはしやすく、トラブルシュートもしやすいが、ランニングコストがかかり、実稼働までの時間がかかる
  - クラウド：サーバーのスペックを臨機応変に変えやすい＝システムの変更要求に対応しやすい、サービス事業者の提供するものの範囲でしか利用できない
  - ハイブリッドクラウド：社内のオンプレとクラウド環境をVPNでつなぎ、2つのいいとこ取りをする
- クラウドサービスの種類
  - IaaS：Infrastrucute as a Service
    - CPU・メモリ、OSなどのインフラ部分を提供するタイプのクラウドサービス
    - EC2とか
    - システム管理者は、管理画面（コンソール）で、CPUの数やメモリの数、OSなどを選ぶ
    - 選んだら、OSだけがインストールされた空のコンピュータが提供され、必要なソフトウェアのインストールは自分たちで行なう
  - Paas：Platform as a Service
    - アプリケーションを実行するための環境（プラットフォーム）を提供するためのクラウドサービス
      - RDSとか
      - システム管理者は、管理画面で、使用したいプログラミング言語やデータベースの種類など、アプリケーション的な要素を選ぶ
        - 必要に応じて、インフラ的な要素も選ぶ
        - pythonのanaconda的な感じかな。あのイメージ。
      - 選んだら、指定したアプリケーションの実行環境が提供される
  - SaaS：Software as a Service
    - ソフトウェアを提供するタイプのクラウドサービス
    - ユーザは用意されたURLにアクセスし、Webブラウザからサービスを利用する
- 自社か、データセンターか
  - 設備、コスト、駆けつけ対応などで判断
  - 設備はデータセンターのほうがいい（プロなので）
  - コストは場合によりけり
    - データセンターは借りるので、レンタルするための諸々のお金がかかる
    - 自社はサーバールームの運用で実際にどれくらいかかるかを計算する
    - どっちがいいかで判断する
  - 自社のほうがすぐに駆けつけられる（それはそう）
    - データセンターにも都市型、郊外型がある
- サーバーを仮想化するか、しないか
  - 仮想化ソフトウェアを利用して、ハードウェアを仮想ハードウェアとして論理的に分割し、OSに割り当てる
  - 仮想化は管理面でのメリットが大きい
    - 設置スペースが増えるのを考えなくていいし、別のサーバーに仮想マシンを移動しやすいので
  - 一方で、パフォーマンスの劣化リスクがある
    - 仮想マシン自体を動かすのに色々な処理が走っているため
- ホストOS型：仮想化ソフトウェアがアプリケーションソフトウェアの1つとして動作する
  - 物理マシンのOSに仮想化ソフトウェアをインストールし、仮想マシンを動作させる
  - VirtualBoxとか
  - ホストOSにも影響があるので、それ自体のCPUやメモリを消費する
  - 検証環境には良いが、本番環境には向かない
- ハイパーバイザー型：OSとして動作する
  - サーバーに直接インストールした仮想化ソフトウェア上で、仮想マシンを動作させる
  - KVMとか
  - 全ての仮想マシンが「ハイパーバイザー」という制御プログラムの上で並列に動作する
  - 仮想化ソフトウェアだけを介してハードウェアを使えるので、ホストOS型よりも処理遅延が小さく、本番環境でもよく使われている
- サーバーをコンテナ化するか、しないか
  - 複数の仮想マシンが同じOSを使用する環境の場合、仮想マシンごとにOSを用意する必要があり、リソースが重複してしまう、という問題があった
  - それを解決するのがコンテナ
- サーバーの形状
  - オンプレ型の場合、どんなハードウェアでサーバーを構築するかも考える必要がある
  - タワー型
  - ラックマウント型
  - プレード型
- サーバーはどんなコンポーネントから構成されるのか
  - コンポーネントをパワーアップすることで、サーバー自体が強くなっていく
  - CPU
    - マルチコア化によって、処理能力を向上させられるようになった
  - メモリ
    - エラー自動訂正機構（ECC機構）、メモリミラーリング（冗長化）の機能がついており、信頼性向上につながっている
  - ストレージドライブ
    - RAIDによる冗長化
  - NIC
    - チーミングによる帯域の増、冗長化が進んでいる
- Linux系サーバーOSとWindows系サーバーOS
  - サーバーOS：サーバーとしてより安定的に動作するために開発・調整されたOSのこと
  - サーバーOSは2つしかない
  - Linux系はCLI（コマンドライン）操作が基本。オープンソース。
  - Windows系はGUI操作ができる。有償。
- アプライアンスサーバー
  - 特定のサービスや機能だけに特化して作られたサーバー
  - 導入・運用が簡単
    - サービスを提供するために必要なOSやサーバーソフトウェアがインストールされた状態で出荷されるため
  - マネージドな分、決められたことしかできない
- 仮想アプライアンスサーバー
  - 設置スペースが不要→コストの節約になる
  - 処理性能は物理サーバーより劣る
- 仮想化って流行っているんだなぁ 
  - 仮想化によって管理するサーバーの台数が増えたので、サーバーの構成管理ツールというものも普及した
    - ansibleが有名
## 04 社内サーバーの基本
- 社内サーバー：社内のクライアントに対してサービスを提供するサーバー
- オンプレかクラウドか
  - オンプレ：インターネット回線帯域（容量）を節約できる、クラウドサービスにかかるランニングコストはかからない
  - クラウド：インターネットと通信する社内サーバはクラウドに配置してもよい
    - インターネット回線の圧迫には繋がるが、止めてはいけないサーバーなら管理をクラウド事業者に任せられるメリットもある
    - セキュリティの問題がついて回るので、通信の暗号化やVPNの設置が必須になってくる
- DHCPサーバー：ネットワークに関連する設定情報をDHCPクライアントに配布するサーバー
  - 動的にIPアドレスを割り当てるときに使われるプロトコルがDHCP
    - 自動割り当てなのでIPアドレスの管理が楽になる
  - IPアドレスは2通りで割り当てられれる
    - 静的：手動で設定
    - 動的：サーバーがクライアントに対して、ネットワーク関連の設定情報を配布して、自動で設定
      - この時使用されるプロトコルがDHCP
  - アドレスプール：クライアントに配布するアドレスの範囲
  - 除外IPアドレス：クライアントに配布してはいけないアドレス
  - クライアントがネットワークに接続してくると、DHCPサーバーがアドレスプールの中から未使用のIPアドレスをクライアントに配布してくれる
  - クライアントは、使用時間が過ぎたり、ネットワークから切断したりすると、与えられていたアドレスを返却する
- DNSサーバー：名前解決してくれる
  - キャッシュサーバー
    - LANの中にいるクライアントからの問い合わせを受け、代理でインターネットに問い合わせてくれる
  - コンテンツサーバー
    - 外部のコンピュータから自分が管理するドメインに関する問い合わせに対応する
      - 自ドメイン内のホスト名は「ゾーンファイル」で管理する
  - 冗長化が基本（壊れたら名前解決できず、webサーバーにアクセスできないので）
    - キャッシュサーバーの冗長化：名前解決した結果をキャッシュするしか役割を持っていないので、サーバー側で設定することはない
      - クライアントOS側で、これがプライマリのキャッシュサーバ、こっちがセカンダリのキャッシュサーバです、という指定をして、応答がない場合にクライアント側が問い合わせし直す、という仕組み
    - コンテンツサーバーの冗長化
      - 「ゾーン転送」をして、プライマリサーバとセカンダリサーバでゾーンファイルを同期しておく
- Windowsコンピュータで作るネットワークは2種類
  - ワークグループ
    - ユーザーアカウントを分散管理する
    - イニシャルコストが少ない
  - **Active Directory**
    - ユーザアカウントを一元管理
      - アカウント管理用のサーバを別途立てる必要がある
    - ランニングコストが少ない
- ファイルサーバー
  - ネットワーク内でのコンピュータ同士のファイル共有、データのやり取りを実現する
  - 社内でのファイルの集中管理が実現する、複数のクライアントで同時編集した時の更新のクラッシュを防げる
  - アクセス権とクォータの設定が大事
    - アクセス権：誰がどのファイルに何をできるかの設定
      - Active Directoryと連携して、アクセス権の制御が可能
    - クォータ：ユーザが使用しているディスク容量の監視、制御の設定
  - NAS（Network Attached Storage）：ファイルサーバーと同じ役割を持つ機器
    - ファイルを管理したいときに使える製品って覚えておけばいいのかな
- SSOサーバー
  - Single Sign Onを提供するサーバー
  - エージェント方式
    - システムを構成するサーバーに認証用のエージェントプログラムを入れ、それ経由でSSOサーバーと認証情報をやり取りする
  - リバースプロキシ方式
    - SSOサーバーがユーザから認証要求のリクエストを受けると、認証サーバーとの認証処理を代理で行い、その結果を踏まえて背後のWebサーバーにデータを渡す
  - SAML方式
    - 複数のクラウドサービスでSSOするときに使う
    - IdP（Identity Provider）がSSOサーバー的な役割を担う、成功したらSP（Service Provider、連携サービス）にも認証情報を渡し、認証なしでいろんなサービスにログインできるようになる
- SIPサーバー
  - Session Initiation Protocolを使って、IP電話の呼制御（電話をかける、切る）を行なうサーバー
  - レジストラサービス、ロケーションサービス、プロキシサービス、リダイレクトサービス
- プロキシサーバー
  - プロキシ：代理
  - クライアントからインターネットに対する通信を代理で行うサーバー
  - インターネットに対する通信を一元的に管理できるようになる
  - 最近はセキュリティ強化の目的で使われることが多い
- メールサーバー
  - 送信メールサーバー
    - SMTP: Simple Mail Transfer Protocolを使ってメールを配送するサーバー
    - メールアドレスの@の後ろのドメインを見て、DNSによってあて先のSMTPサーバーを探す
      - 郵便ポストみたいなイメージ
    - 宛先側のSMTPサーバーは、宛先メールアドレスの@の前を見て、どのユーザーに送るかを判断する
  - 受信メールサーバー
    - SMTPサーバーはデータを送信したいときにデータを送るpush型のプロトコル（電源が常にONなサーバーへの通信やサーバー間の通信だとリアルタイムにデータのやり取りができるが、電源がOFFなサーバーにはそれができない）
    - POP: Post Office Protocol
    - IMAP: Internet Message Access Protocol
    - この子たちはプル型。電源がオンになっていて、かつ欲しい時だけメールをダウンロードできる
    - 違いはメールデータの管理方法。POPはメールソフトウェアの中で、IMAPはメールサーバーの中で管理する
- Microsoft Exchange Server
  - マイクロソフトのサーバーソフトウェア。メールサービスやグループウェアサービスを統合的に提供してくれる

## 05 公開サーバーの基本
- 公開サーバー：インターネット上のクライアントに対して、サービスを提供するサーバー
  - 24h365で常時稼働が基本、高度な運用／管理能力が求められる
  - オンプレでもクラウドでも、提供するサービスの内容に変わりはない（運用方法が異なるだけ）
  - オンプレの既存システムと連携する必要がある公開サーバーは、DMZ（オンプレ環境でインターネットから接続できるネットワーク）に配置したほうがいい
- オンプレで公開する手順
  - インターネット回線を敷設する
  - グローバルIPアドレスを取得する
    - 固定アドレスで公開するのがセオリー
  - ドメイン名を申請する
  - 公開サーバーを用意する
  - ファイアウォールでNAT（名前解決）する
  - ファイアウォールで必要な通信を許可する
- クラウドで公開する手順
  - ドメイン名を申請する
  - 公開サーバーを用意する
    - EC2など
  - グローバルIPアドレスを割り当てる
  - Route53にドメインを登録する
    - ＝DNSサーバーが立てられる、と捉えてよさそう
  - 固定IPアドレスとホストを関連づける
  - セキュリティグループ（EC2のファイアウォール機能）で必要な通信を許可する
- Web3階層モデル（プレゼンテーション層、アプリケーション層、データ層）
  - Webサーバー、アプリケーションサーバー、データベースサーバーで役割を分担して処理する
  - Webサーバー：ブラウザからリクエストを受けて、静的ページに対するリクエストならファイルを返し、動的ページに対するリクエストならアプリケーションサーバーに処理をリクエストする
  - アプリケーションサーバー：Webサーバーからのリクエストに応じてプログラムを実行し、動的WebページにしてWebサーバーに返す、データベースサーバーの情報が必要な時は、データベースサーバーにリクエストし、データベースサーバーから返ってきた値も含めて動的ページを作り、Webサーバーに返す
  - データベースサーバー：データを格納する。アプリケーションサーバーからのリクエストに応じて、データの検索や更新を行う
- HTTPサーバー（プレゼンテーション層（のはず））
  - Apache、nginxとか
    - どっちもLinuxで動かすのが基本だが、WindowsOSでも動く
    - Apacheは動的ページ、nginxは静的ページの処理が得意
  - クラサバモデル
  - ブラウザはHTTPサーバーにアクセスするとき、メソッド（何をしたいか）とURL（サーバーの場所）の情報を送る
- HTTPSサーバー
  - HTTPには暗号化機能はない
  - SSL（Secure Socket Layer）/TLS（Transport Layer Security）で暗号化してデータを送る
  - OpenSSL, IISが有名どころのソフトウェア
  - 共通鍵暗号方式と公開鍵暗号方式の2つを組み合わせて暗号化してくれる
  - 証明書をHTTPSサーバーにインストールしないと、HTTPSでの通信にならない
- アプリケーションサーバー
  - アプリケーションサービスを提供するソフトウェアはプログラミング言語によって異なる
    - なるほど、「アプリケーション」って定義として捉えていいのかな
  - データベース接続機能とトランザクション管理機能がAPサーバーの代表的機能
    - データベースに接続する機能
    - Webアプリケーションにおける一連の処理を管理する機能
- データベースサーバー
  - データベースの機能を提供するソフトウェアをDBMS（DataBase Management System）
  - 主流はリレーショナルデータベース
    - 代表的なソフトウェアはRDBMS
      -  Oracle Database, MySQL, SQL Serverとか
 -  SQLで操作する
-  CDN : Content Delivery Network
   - オリジンサーバー（ファイルの原本を持っている自社のサーバー）とエッジサーバー（オリジンサーバーから返ってきたファイルをキャッシュしてくれる）
   - アクセスしてきたユーザに物理的に近いエッジサーバーが応答してくれる
- FTPサーバー
  - ファイルを転送するサーバー
  - FTPは暗号化されていないので、認証が大切になってくる
- VPNサーバー
  - WANを利用して、仮想的な専用線を作る技術
## 06 サーバーを障害から守る
- 障害対策の柱は冗長化とバックアップ
- 冗長化
  - RAID（Redundant Arrays of Inexpensive Disks, レイド）
    - 複数のストレージドライブ（HDD／SSD）を1つのドライブのように見せて、冗長化と高速化を図る
    - RAID1：ミラーリングによるRAID
      - 複数のドライブに同じデータをコピーする。ドライブのコピーを増やしていく。シンプル。
    - RAID5：分散パリティによるRAID
      - データを修復するためのデータ（パリティ）を複数のドライブに分散して保存する
      - データとパリティを複数のドライブに保存する
    - RAID1＋0：RAID1にストライピング（RAID0で使われている）によるRAID
      - ストライピング：複数のドライブに分散してデータを書き込む（高速化を図る）
  - チーミング
    - 複数の物理NIC（Network Interface Card, コンピュータをLANに接続するための部品）を1つの論理NICにまとめる技術
    - フォールトトレランス
      - 単にNICの冗長化、アクティブ／スタンバイ方式で、片方のどちらかが常に動いている感じ。1個に障害があるともう1つにfailoverする
    - ロードバランシング
      - NICの冗長化＋帯域拡張もする
  - クラスター
    - 複数のサーバーをネットワークに接続し、全体で1台のサーバーのように見せる技術
      - 1つのチームを組むみたいな？
    - クラスターを組むには「クラスターソフトウェア」が必要
    - 「ハートビート」によって他のクラスターが生きていることをクラスター同士で確認し合う
      - いわば生存確認
    - アクティブサーバーからの応答がなくなると、スタンバイサーバーがfail overで入れ替わる
    - 共有ストレージ構成とデータレプリケーション構成の2つが組み方の主流
      - 複数のサーバーがストレージを共有するか、ローカルストレージのコピーをネットワークで送るか
  - サーバー負荷分散技術
    - その名の通り
    - DNSラウンドロビン
      - DNSを使って負荷分散する
      - 1つのドメインに複数のIPアドレスを登録しておき、ランダムにクライアントからのリクエストを振り分ける
        - 障害が起きているサーバーにも処理を送ってしまうこともある（生きているサーバーにだけ送るみたいな賢いことはできない）
    - サーバータイプ
      - サーバーにインストールしたソフトウェアによって負荷分散する
        - NLB（Network Load Balancer）, LVS(LinuxVirtualServer)
    - アプライアンスサーバータイプ
      - サーバー負荷分散専用のサーバーを立てる
  - 広域負荷分散技術
    - 分散させる通信を均等にしたり、サーバーの障害を検知した対応をしたりしてくれる
    - Route53がそれ
    - クラウド事業者が用意してくれているのを使うのが一般的
- バックアップ
  - UPS
    - 電源障害からサーバーを守る
    - 急な停電が起きても、適切にシャットダウンしてくれる（停電と同時にシャットダウン、を防いでくれる）
    - バッテリーを内蔵していて、停電が起きたらソフトウェアに停電が起きたことを伝え、ソフトウェアのシャットダウンが終わったら給電が止まるようにしてくれる
## 07 サーバーのセキュリティ
- 脅威：システムへの攻撃
- 脆弱性：システムの弱点、欠点
- ファイアウォール：ネットワークの出入り口に配置する機器
  - トラディショナルファイアウォール
    - IPアドレスとポート番号のみ指定
    - 要は必要最低限
  - 次世代ファイアウォール
    - トラディショナルの進化版
    - いろんなセキュリティ機能が詰め込まれている
    - 今の主流なファイアウォール
  - Webアプリケーションファイアウォール（WAF）
    - Webサービスをアプリケーションレベルで守る
    - ブラウザとWebサーバー間のやり取りを全て監視してくれる
- セキュリティゾーン
- IDS/IPS
- 次世代ファイアウォール
- WAF
- メールのセキュリティ
## 08 サーバーの運用管理
