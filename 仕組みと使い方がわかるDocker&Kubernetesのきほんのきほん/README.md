# 仕組みと使い方がわかるDocker&Kubernetesのきほんのきほん


<!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->

<!-- code_chunk_output -->

- [仕組みと使い方がわかるDocker&Kubernetesのきほんのきほん](#仕組みと使い方がわかるdockerkubernetesのきほんのきほん)
  - [01 Dockerとは何だろう](#01-dockerとは何だろう)
    - [01 Dockerって何だろう](#01-dockerって何だろう)
    - [02 サーバとDocker](#02-サーバとdocker)
  - [02 Dockerが動く仕組み](#02-dockerが動く仕組み)

<!-- /code_chunk_output -->

## 01 Dockerとは何だろう

### 01 Dockerって何だろう
- 「データやプログラムを隔離できる」仕組みのこと
  - データ、プログラムだけでなく、OS（厳密にはOSではない）ごと隔離できる
- データやプログラムは「コンテナ」に入れることで独立できる
  - コンテナは物置みたいなもの
  - コンテナを使える仕組みがDocker
-  Dockerを動かすにはDocker Engineのインストールが必要
   -  コンテナでデータやプログラムを管理したい→Dockerが必要→Docker Engineが必要、という流れだと理解
-  コンテナはイメージから作る
   -  「〇〇のコンテナを作りたい」となったら「〇〇のイメージを使う」という流れになる、これはたぶんおまじない
   -  イメージはISOファイルに近い（CD、DVDをファイルに出力したもの。これがあれば元のCDやDVDを復元できる）。イメージがあればコンテナを復元できる、ということ
-  Dockerを動かすにはLinux OSが必要
-  データやプログラムを隔離したい理由
   -  プログラムは実行環境、ライブラリに依存して動いているため
   -  一部の都合で変更すると、他のものが動かなくなってしまう、ということがありうる
      -  サーバに何かのプログラムを同居させる場合、共有部分でトラブることがよくある
   -  この同居問題を解決してくれるのがDockerコンテナ

### 02 サーバとDocker
- サーバ…サービスを提供するもの
  - webサーバ：web機能を提供する
  - メールサーバ：メール機能を提供する
  - 複数の人がアクセスして使うのが、個人のノートPCと異なる
  - **サーバを作る＝あるソフトを入れて、その機能を持たせること**
- サーバには2種類ある
  - 機能としてのサーバ
    - webサーバ、メールサーバ、ファイルサーバ、etc...

サーバ | 特徴 
---------|----------
 webサーバ | webサイトの機能を提供するサーバ。HTMLファイル、画像ファイル、プログラムなどを置いておく。クライアントのブラウザがアクセスしてくると、それらのファイルを提供する
 メールサーバ | メールの送受信を担当するSMTPサーバと、クライアントにメールを受信させるPOPサーバの2つを合わせてメールサーバと呼ぶことが多い
 データベースサーバ | データを保存したり、検索したりするためのデータベースを置くサーバ。代表的なソフトはMySQL、PostgreSQLなど
 ファイルサーバ| ファイルを保存して、共有するサーバ
 DNSサーバ|IPアドレスと、ドメインを結びつけるDNS機能をもつサーバ
 DHCPサーバ|IPアドレスを自動的に振る機能を持つサーバ
 FTPサーバ|FTPプロトコルを使って、ファイルの送受信を行うサーバ。Webサーバと同居させることが多く、ファイルの設置に使う
 プロキシサーバ|通信を中継する役割を持つおサーバの総称。社内LANなど、インターネットから隔離された場所からインターネット上のサーバに接続するときに使う
 認証サーバ|ユーザを認証するためのサーバ。Windowsネットワークにログインするための「Active Directory」が有名

  - 物理的なマシンとしてのサーバ
    - EC2とかだよね、オンプレだと文字通り物理のサーバ、デスクトップのPCもそう
    - 機能としてのサーバを1つの物理的なマシンに複数同居させることが可能
- サーバのOSはLinuxが圧倒的優位
- コンテナを使えば、複数のサーバ機能を安全に同居させることができる
  - サーバマシン代の節約にもなる
- コンテナは持ち運べる
  - 同じ状態にチューニングしたコンテナを全員に配布し、開発環境をチームメンバ全員で統一するのも簡単
    - 各々にDockerが入っていさえすればいい
- Dockerは仮想化技術とイコールではない
  - 仮想化技術：VirtualBoxとか
    - 実質物理的なマシン、CPUとかも中身に含まれている
  - DockerはあくまでOSぽいものしかコンテナ上にない
    - OSの機能のいくつかは、ホストになっている（＝エンジンをインストールしている？）物理的なマシンに依存している
  - EC2も仮想化環境（VirtualBoxと同じ）。インスタンスはAMIというイメージから作るので、配布方法は似ている
- Dockerとホスティングサービス
  -  AWSのECSが有名どころ
  -  サーバを作ることなく、コンテナイメージを運用できる

## 02 Dockerが動く仕組み